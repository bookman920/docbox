# GIP0010 多用户管理模式
Layer: Consensus
Title: Multi Account Management
Status: Draft
Author：bookman
Type: Standards Track
Created: 2018-10-16
Summary：在现有全节点基础上扩展而来的多用户管理机制

## 设计意图

本案的基本设计思路，是将特定用户的所有转账操作，限定在分层确定性钱包的特定账户内，从而实现多用户间帐务隔离

## 应用场景

### 轻钱包管理后台

为了向用户屏蔽技术细节以降低使用门槛，轻钱包并不在本地管理钱包，而是将关键操作全部委托到远方的轻钱包管理后台。
轻钱包管理后台通过绑定一个特约全节点，管理着一个超级钱包，其中包含了海量的账户，每个账户由用户编号来标识(OPENID)，区隔开了用户的私钥、地址、道具等信息。

原有账户操作相关的所有调用，都需要完成多用户模式改造：
- 调用时附加 OPENID 参数，将以多账户模式运行，操作将限定在独立账户中执行。
- 调用时省略 OPENID 参数，将以单账户模式运行。

轻钱包管理后台接受轻钱包委托、向特约全节点发起RPC调用时，统一采用 config.root 作为终端编码进行授权访问，即Root模式
具体调用中的账户字段，填写轻钱包本身的OPENID

### 游戏商分服管理后台

考虑一个游戏商需要管理不同的游戏，或者相同游戏不同分服的场景。
在这个场景中，游戏商统一架设一台特约全节点，与此同时每一台游服都会被分配一个终端编码(OPENID)，从而被映射到一个独立账户上，区隔开了各服的私钥、地址、道具等信息。
授权终端向特约全节点发起RPC调用时，采用其自身的终端编码(不同于 config.root)进行授权访问，即标准模式
具体调用中的账户字段，直接带入自身终端编码

## 账户管理

本案涉及的多账户体系，架构在分层确定性钱包账户路径的第四层，第五层仍旧分为收款、找零、嵌套三类，每类下都可以拥有海量地址。

轻钱包应用场景中，用户收款地址可分为两个不同类别：
1、自然顺序生成的一系列收款地址
2、通过传入游戏编码、游戏内用户编码、OPENID三个信息至 token.user 函数，生成的认证证书中的地址，该地址是游戏服进行道具确权的唯一有效地址。
